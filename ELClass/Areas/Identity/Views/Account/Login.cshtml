@using Models.ViewModels
@model LoginVM

@{
    var currentLang = Context.Session.GetString("Language") ?? "en";
    var direction = currentLang == "ar" ? "rtl" : "ltr";
}

<main class="main" id="top" style="direction:@direction;">
    <div class="container" data-layout="container">
        <div class="row flex-center min-vh-100 py-6">
            <div class="col-sm-10 col-md-8 col-lg-6 col-xl-5 col-xxl-4">

                <div class="text-end mb-2">
                    <button type="button" class="btn btn-link btn-sm p-0" onclick="changeLanguage()">
                        @(currentLang == "ar" ? "English" : "العربية")
                    </button>
                </div>

                <div class="card">
                    <div class="card-body p-4 p-sm-5">
                        <div class="row flex-between-center mb-2">
                            <div class="col-auto">
                                <h5>@(currentLang == "ar" ? "تسجيل الدخول" : "Log in")</h5>
                            </div>
                            <div class="col-auto fs--1 text-600">
                                <span class="mb-0">@(currentLang == "ar" ? "أو" : "or")</span>
                                <span><a href="/Identity/Account/Register">@(currentLang == "ar" ? "إنشاء حساب جديد" : "Create an account")</a></span>
                            </div>
                        </div>

                        <form method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
                            <div class="mb-3">
                                <input class="form-control"
                                       type="text"
                                       placeholder="@(currentLang == "ar" ? "البريد الإلكتروني أو اسم المستخدم" : "Email address Or UserName")"
                                       asp-for="EmailOrUserName" />
                                <span class="text-danger" asp-validation-for="EmailOrUserName"></span>
                            </div>

                            <div class="mb-3">
                                <input class="form-control"
                                       type="password"
                                       placeholder="@(currentLang == "ar" ? "كلمة المرور" : "Password")"
                                       asp-for="Password" />
                                <span class="text-danger" asp-validation-for="Password"></span>
                            </div>

                            <div class="row flex-between-center">
                                <div class="col-auto">
                                    <div class="form-check mb-0">
                                        <input class="form-check-input" type="checkbox" id="basic-checkbox" checked="checked" />
                                        <label class="form-check-label mb-0" for="basic-checkbox">
                                            @(currentLang == "ar" ? "تذكرني" : "Remember me")
                                        </label>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <a class="fs--1" href="/Identity/Account/ForgetPassword">
                                        @(currentLang == "ar" ? "نسيت كلمة المرور؟" : "Forgot Password?")
                                    </a>
                                </div>
                            </div>

                            <div class="mb-3">
                                <button class="btn btn-primary d-block w-100 mt-3"
                                        style="background-color: #F28B00; border-color: #F28B00;"
                                        type="submit" name="submit">
                                    @(currentLang == "ar" ? "دخول" : "Log in")
                                </button>
                            </div>
                        </form>

                        <div class="position-relative mt-4">
                            <hr />
                            <div class="divider-content-center">@(currentLang == "ar" ? "أو الدخول بواسطة" : "or log in with")</div>
                        </div>
                        <div class="row g-2 mt-2">
                            <div class="col-sm-6">
                                <a class="btn btn-outline-google-plus btn-sm d-block w-100" href="#">
                                    <span class="fab fa-google-plus-g me-2"></span> google
                                </a>
                            </div>
                            <div class="col-sm-6">
                                <a class="btn btn-outline-facebook btn-sm d-block w-100" href="#">
                                    <span class="fab fa-facebook-square me-2"></span> facebook
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

@section Scripts {
    <script>
        // وظيفة تغيير اللغة المستخدمة في الـ Register
        function changeLanguage() {
            var newLang = '@currentLang' === 'ar' ? 'en' : 'ar';
            $.ajax({
                url: '/Identity/Account/SetLanguage',
                type: 'POST',
                data: { language: newLang },
                success: function () {
                    location.reload();
                }
            });
        }
    </script>

    @if (TempData["success-notifications"] is not null)
    {
        <script>toastr.success('@TempData["success-notifications"]')</script>
    }
    else if (TempData["error-notifications"] is not null)
    {
        <script>toastr.error('@TempData["error-notifications"]')</script>
    }

    <partial name="_ValidationScriptsPartial" />
}