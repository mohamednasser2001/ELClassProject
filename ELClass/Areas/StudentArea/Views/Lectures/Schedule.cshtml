@model List<Models.ViewModels.UpcomingLectureVM>

@{
    Layout = "_StudentLayout";
    ViewData["Title"] = "Lecture Schedule";

    // =========================
    // Language (Session-based)
    // =========================
    var currentLang = Context.Session.GetString("Language") ?? "en";
    var isArabic = currentLang == "ar";
}

<div class="sd-wrap">
    <div class="sd-card">
        <div class="sd-card-head">
            <div class="sd-head-title">
                <i class="fa-solid fa-calendar-check sd-ic-fa"></i>
                <span>@(isArabic ? "جدول المحاضرات" : "Lecture Schedule")</span>
            </div>
        </div>

        <div class="sd-card-body">

            @if (Model == null || !Model.Any())
            {
                <div class="sd-empty">@(isArabic ? "لا توجد محاضرات مجدولة بعد." : "No lectures scheduled yet.")</div>
            }
            else
            {
                <div class="sd-up-table">
                    <div class="sd-up-row sd-up-head">
                        <div>@(isArabic ? "التاريخ" : "DATE")</div>
                        <div>@(isArabic ? "الكورس" : "COURSE")</div>
                        <div>@(isArabic ? "المُدرس" : "INSTRUCTOR")</div>
                        <div>@(isArabic ? "زووم" : "ZOOM")</div>
                    </div>

                    @foreach (var lec in Model)
                    {
                        var canJoin = DateTime.Now >= lec.Date.AddMinutes(-3);

                        <div class="sd-up-row">
                            <div class="sd-up-time">
                                <div class="sd-up-time-main">@lec.Date.ToString("ddd, dd MMM")</div>
                                <div class="sd-up-time-sub">@lec.Date.ToString(isArabic ? "HH:mm" : "hh:mm tt")</div>
                            </div>

                            <div class="sd-up-course">
                                <div class="sd-up-course-main" title="@lec.SubjectName">@lec.SubjectName</div>
                            </div>

                            <div class="sd-up-inst">
                                <div class="sd-up-inst-main" title="@lec.InstructorName">@lec.InstructorName</div>
                            </div>

                            <div class="sd-up-zoom">
                                @if (canJoin && !string.IsNullOrWhiteSpace(lec.ZoomLink))
                                {
                                    <a class="sd-up-zoom-btn" href="@lec.ZoomLink" target="_blank" rel="noopener">
                                        <i class="fa-solid fa-video"></i> @(isArabic ? "انضم" : "Join")
                                    </a>
                                }
                                else
                                {
                                    <span class="sd-up-zoom-muted">
                                        <i class="fa-regular fa-clock"></i> @(isArabic ? "لم تبدأ بعد" : "Not started")
                                    </span>
                                }
                            </div>
                        </div>
                    }
                </div>
            }

        </div>
    </div>
</div>
