@using ELClass.services
@using Models
@model Lesson

@{
    ViewData["Title"] = "Edit Lesson";
    var isArabic = CultureHelper.IsArabic;
}

<div class="bg-white dark:bg-slate-900 min-h-screen">

    <div class="w-full px-2 sm:px-6 py-4">

        <div class="flex items-center gap-4 mb-6 bg-slate-50 dark:bg-slate-800 p-4 rounded-lg shadow-sm">
            <a asp-action="GetLessons" asp-route-courseId="@Model.CourseId" class="p-2 bg-white dark:bg-slate-700 rounded-full shadow-sm hover:text-primary transition-colors flex items-center justify-center">
                <span class="material-icons">arrow_back</span>
            </a>
            <div>
                <h1 class="text-xl font-bold text-slate-900 dark:text-white leading-tight">@((isArabic) ? "تعديل الدرس" : "Edit Lesson")</h1>
            </div>
        </div>

        <div class="bg-white dark:bg-slate-800 rounded-lg shadow-md border border-slate-200 dark:border-slate-700 overflow-hidden">
            <form asp-action="EditLesson" method="post" class="p-4 md:p-6 space-y-5">

                @* Hidden Fields *@
                <input type="hidden" asp-for="Id" />
                <input type="hidden" asp-for="CourseId" />
                <input type="hidden" asp-for="CreatedById" />

                <div>
                    <label asp-for="InstructorId" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "تعيين مدرس" : "Assign Instructor")</label>
                    <select asp-for="InstructorId" asp-items="ViewBag.Instructors" id="instructorSelect"
                            class="w-full rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm">
                        <option value="">-- @((isArabic) ? "اختر مدرس" : "Select Instructor") --</option>
                    </select>
                    <span asp-validation-for="InstructorId" class="text-red-500 text-[11px] mt-1"></span>
                </div>

                <div>
                    <label asp-for="Title" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "عنوان الدرس" : "Lesson Title")</label>
                    <input asp-for="Title" placeholder="@((isArabic) ? "أدخل اسم الدرس..." : "Enter lesson name...")"
                           class="w-full rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm" />
                    <span asp-validation-for="Title" class="text-red-500 text-[11px] mt-1"></span>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div>
                        <label asp-for="LectureDate" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "تاريخ المحاضرة" : "Lecture Date")</label>
                        <input asp-for="LectureDate" type="date"
                               class="w-full rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm" />
                    </div>

                    <div>
                        <label asp-for="DriveLink" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "رابط جوجل درايف" : "Google Drive Link")</label>
                        <input asp-for="DriveLink" placeholder="@((isArabic) ? "الصق الرابط هنا..." : "Paste link here...")"
                               class="w-full rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm" />
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div>
                        <label asp-for="LecturePdfUrl" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "رابط PDF للمحاضرة" : "Lecture PDF URL")</label>
                        <div class="relative">
                            <span class="material-icons absolute left-3 top-2.5 text-slate-400 text-sm">picture_as_pdf</span>
                            <input asp-for="LecturePdfUrl" placeholder="@((isArabic) ? "رابط PDF للمحاضرة" : "Link to PDF")"
                                   class="w-full pl-10 rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm" />
                        </div>
                    </div>

                    <div>
                        <label asp-for="AssignmentPdfUrl" class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-1.5">@((isArabic) ? "رابط PDF للواجب" : "Assignment PDF URL")</label>
                        <div class="relative">
                            <span class="material-icons absolute left-3 top-2.5 text-slate-400 text-sm">assignment</span>
                            <input asp-for="AssignmentPdfUrl" placeholder="@((isArabic) ? "رابط PDF للواجب" : "Link to Task")"
                                   class="w-full pl-10 rounded-md border-slate-300 dark:border-slate-600 dark:bg-slate-900 dark:text-white focus:ring-primary focus:border-primary text-sm" />
                        </div>
                    </div>
                </div>

                <div class="flex items-center justify-end gap-3 pt-5 border-t border-slate-100 dark:border-slate-700">
                    <a asp-action="Details" asp-route-id="@Model.CourseId" class="text-slate-500 hover:text-slate-800 dark:text-slate-400 dark:hover:text-white text-sm font-medium transition-colors">@((isArabic) ? "إلغاء" : "Cancel")</a>
                    <button type="submit" class="bg-primary hover:bg-orange-600 text-white px-6 py-2 rounded-md font-bold shadow-md transition-all active:scale-95 text-sm">
                        @((isArabic) ? "حفظ التعديلات" : "Save Changes")
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
        <script>
            $(document).ready(function() {
                $('#instructorSelect').select2({
                    placeholder: "@((isArabic) ? "ابحث عن مدرس..." : "Search for instructor...")",
                    allowClear: true,
                    width: '100%'
                });
            });
        </script>

        <style>
            .select2-container--default .select2-selection--single {
                background-color: transparent !important;
                border-color: #cbd5e1 !important;
                height: 38px !important;
                padding: 5px !important;
            }

            .dark .select2-container--default .select2-selection--single {
                border-color: #475569 !important;
                color: white !important;
            }

            .dark .select2-selection__rendered {
                color: #f8fafc !important;
            }
        </style>
    }
}