@using Microsoft.AspNetCore.Identity
@using Models
@using DataAccess.Repositories.IRepositories
@inject UserManager<ApplicationUser> UserManager
@inject IUnitOfWork _unitOfWork
@{
    var user = await UserManager.GetUserAsync(User);
    var userImage = user?.Img;
    var displayName = user?.NameEN ?? user?.UserName;
    var isArabic = System.Globalization.CultureInfo.CurrentCulture.TwoLetterISOLanguageName == "ar";
    var unreadCount = await _unitOfWork.ContactUsRepository.CountAsync(e => e.IsReaded == false);
}

<!doctype html>
<html lang="@(isArabic ? "ar" : "en")">
<head>
    <title>@(isArabic ? "لوحة تحكم ElClass" : "ElClass Dashboard")</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui" />
    <link rel="icon" href="~/Images/Logos/logos-03.png" type="image/x-icon" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" id="main-font-link" />
    <link rel="stylesheet" href="~/assets/fonts/phosphor/duotone/style.css" />
    <link rel="stylesheet" href="~/assets/fonts/tabler-icons.min.css" />
    <link rel="stylesheet" href="~/assets/fonts/feather.css" />
    <link rel="stylesheet" href="~/assets/fonts/material.css" />
    <link rel="stylesheet" href="~/lib/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="~/css/color-tokens.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/bootstrap-overrides.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/assets/css/style.css" id="main-style-link" />
    <link rel="stylesheet" href="~/assets/css/style-preset.css" />
    <link rel="stylesheet" href="~/assets/css/berry-color-overrides.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/assets/css/preset-color-overrides.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/admin-components.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>

    <nav class="pc-sidebar">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="/Admin/Home/Index" class="b-brand text-primary">
                    <img src="/images/logos/logos-01.png" alt="logo" width="150" class="logo " />
                </a>
            </div>
            <div class="navbar-content">
                <ul class="pc-navbar">
                    <li class="pc-item pc-caption">
                        <label>@(isArabic ? "لوحة التحكم" : "Dashboard")</label>
                        <i class="ti ti-dashboard"></i>
                    </li>
                    <li class="pc-item">
                        <a href="/Admin/Home/Index" class="pc-link">
                            <span class="pc-micon"><i class="fa-solid fa-house"></i></span>
                            <span class="pc-mtext">@(isArabic ? "الرئيسية" : "Home")</span>
                        </a>
                    </li>

                    <li class="pc-item pc-caption">
                        <label>@(isArabic ? "العناصر" : "Elements")</label>
                        <i class="ti ti-apps"></i>
                    </li>
                    <li class="pc-item">
                        <a href="/admin/Course/index" class="pc-link">
                            <span class="pc-micon"><i class="fa-solid fa-laptop-code"></i></span>
                            <span class="pc-mtext">@(isArabic ? "الكورسات" : "Courses")</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <a href="/admin/instructor/index" class="pc-link">
                            <span class="pc-micon"><i class="fa-solid fa-person-chalkboard"></i></span>
                            <span class="pc-mtext">@(isArabic ? "المحاضرين" : "Instructors")</span>
                        </a>
                    </li>
                    <li class="pc-item">
                        <a href="/admin/Student/index" class="pc-link">
                            <span class="pc-micon"><i class="fa-solid fa-people-roof"></i></span>
                            <span class="pc-mtext">@(isArabic ? "الطلاب" : "Students")</span>
                        </a>
                    </li>
                    @if (User.IsInRole("SuperAdmin"))
                    {
                        <li class="pc-item">
                            <a href="/admin/user/index" class="pc-link">
                                <span class="pc-micon"><i class="fa-solid fa-users"></i></span>
                                <span class="pc-mtext">@(isArabic ? "المستخدمين" : "Users")</span>
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <header class="pc-header">
        <div class="header-wrapper">
            <div class="me-auto pc-mob-drp">
                <ul class="list-unstyled">
                    <li class="pc-h-item header-mobile-collapse">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="sidebar-hide">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                    <li class="pc-h-item pc-sidebar-popup">
                        <a href="#" class="pc-head-link head-link-secondary ms-0" id="mobile-collapse">
                            <i class="ti ti-menu-2"></i>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="ms-auto">
                <ul class="list-unstyled">
                    <li class="pc-h-item">
                        <a href="/Home/SetLanguage?culture=@(isArabic ? "en-US" : "ar-EG")&returnUrl=@Context.Request.Path"
                           class="pc-head-link head-link-secondary d-flex align-items-center justify-content-center"
                           style="width: 40px; height: 40px; text-decoration: none;"
                           title="@(isArabic ? "Switch to English" : "التغيير للعربية")">

                            @if (isArabic)
                            {
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" style="width: 100%; height: 100%; transform: scale(1.4);">
                                    <rect x="1" y="4" width="30" height="24" rx="4" ry="4" fill="#071b65"></rect>
                                    <path d="M5.101,4h-.101c-1.981,0-3.615,1.444-3.933,3.334L26.899,28h.101c1.981,0,3.615-1.444,3.933-3.334L5.101,4Z" fill="#fff"></path>
                                    <path d="M22.25,19h-2.5l9.934,7.947c.387-.353,.704-.777,.929-1.257l-8.363-6.691Z" fill="#b92932"></path>
                                    <path d="M1.387,6.309l8.363,6.691h2.5L2.316,5.053c-.387,.353-.704,.777-.929,1.257Z" fill="#b92932"></path>
                                    <path d="M5,28h.101L30.933,7.334c-.318-1.891-1.952-3.334-3.933-3.334h-.101L1.067,24.666c.318,1.891,1.952,3.334,3.933,3.334Z" fill="#fff"></path>
                                    <rect x="13" y="4" width="6" height="24" fill="#fff"></rect>
                                    <rect x="1" y="13" width="30" height="6" fill="#fff"></rect>
                                    <rect x="14" y="4" width="4" height="24" fill="#b92932"></rect>
                                    <rect x="14" y="1" width="4" height="30" transform="translate(32) rotate(90)" fill="#b92932"></rect>
                                    <path d="M28.222,4.21l-9.222,7.376v1.414h.75l9.943-7.94c-.419-.384-.918-.671-1.471-.85Z" fill="#b92932"></path>
                                    <path d="M2.328,26.957c.414,.374,.904,.656,1.447,.832l9.225-7.38v-1.408h-.75L2.328,26.957Z" fill="#b92932"></path>
                                    <path d="M27,4H5c-2.209,0-4,1.791-4,4V24c0,2.209,1.791,4,4,4H27c2.209,0,4-1.791,4-4V8c0-2.209-1.791-4-4-4Zm3,20c0,1.654-1.346,3-3,3H5c-1.654,0-3-1.346-3-3V8c0-1.654,1.346-3,3-3H27c1.654,0,3,1.346,3,3V24Z" opacity=".15"></path>
                                    <path d="M27,5H5c-1.657,0-3,1.343-3,3v1c0-1.657,1.343-3,3-3H27c1.657,0,3,1.343,3,3v-1c0-1.657-1.343-3-3-3Z" fill="#fff" opacity=".2"></path>
                                </svg>

                            }
                            else
                            {
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" style="width: 100%; height: 100%; transform: scale(1.4);">
                                    <rect x="1" y="4" width="30" height="24" rx="4" ry="4" fill="#215230"></rect>
                                    <path d="M27,4H5c-2.209,0-4,1.791-4,4V24c0,2.209,1.791,4,4,4H27c2.209,0,4-1.791,4-4V8c0-2.209-1.791-4-4-4Zm3,20c0,1.654-1.346,3-3,3H5c-1.654,0-3-1.346-3-3V8c0-1.654,1.346-3,3-3H27c1.654,0,3,1.346,3,3V24Z" opacity=".15"></path>
                                    <path d="M27,5H5c-1.657,0-3,1.343-3,3v1c0-1.657,1.343-3,3-3H27c1.657,0,3,1.343,3,3v-1c0-1.657-1.343-3-3-3Z" fill="#fff" opacity=".2"></path>
                                    <path d="M25.47,15.008c.105-.506-.616-3.171-.092-2.76,.071-.184-.288-.624-.39-.863-.362,1.107,.47,3.281,.2,4.749-.205,.431-1.607,.948-1.937,1.134,.74,.218,2.5-.651,2.218-2.26Z" fill="#fff"></path>
                                    <path d="M10.505,16.004c.189-.342,.23-.711,.203-1.119,.285-.116,.625-.309,.739-.323-.078,.268,.108,.557,.485,.52,.075,2.143,.346,1.695,.235-.061,.244-.113,.285-.331,.376-.424,.529,.867,1.302-.28,.818-.752-.005,.039-.118,.415-.118,.415,0,0,.108,.114,.113,.17-.117,.14-.654,.045-.621-.172,.026-.059,.152-.363-.028-.182-.163,.166-.247,.518-.574,.578,.021-.738-.397-2.077-.198-2.519,.186,.233,.189,.069,.075-.16-.189-.337-.287-.981-.469-.283,.189,.786,.217,2.078,.349,2.962-.361-.07-.248-.325-.244-.489-.049-.033-.698,.313-.968,.396-.032-.274-.072-.521-.089-.724,1.012-.097,.623-1.314,.414-1.883,.025-.034,.297,.197,.133-.076-.251-.317-.358-.681-.477-.079,.157,.294,.301,1.089,.451,1.42-.103,.073-.337,.195-.569,.188,.019-.348-.281-1.172-.047-1.233,.161,.185,.185,.105,.072-.126-.195-.297-.349-1.048-.488-.321,.167,.343,.096,.842,.207,1.609-.632-.338-.133-1.385-.652-1.885-.024,.057-.13,.41-.13,.41,.515,.73-.338,2.343-1.17,1.331-.098-.544,.476-2.27-.336-.957-.16,.529-.555,2.134-1.013,.927-.089-.336,.098-1.28-.115-.503-.119,.293,.045,1.443,.567,1.308,.471-.253,.488-1.453,.854-1.754-.724,1.53,.977,2.599,1.429,.747,.013,.287,.224,.749,.612,.848,.023,.228,.06,.525,.094,.838-.072,.022-.144,.042-.217,.059-.605-1.576-2.019,.892-.179,.401,.024,.072,.04,.143,.042,.207-.852,1.187-3.966,1.185-1.934-.889,.066,.024,.191,.147,.18,.158,.073-.112,.11-.232-.09-.308,.33-.876-.875-.159-.14,.119-.149,.156-.5,.385-.715,.519-.167,.094-.68,.407-.803,.479-.057,.104,.455-.213,.61-.266-1.488,2.836,2.314,2.381,3.326,.88Zm-3.208-.938c.106-.053,.207-.104,.29-.15-1.363,2.364,2.618,1.812,2.664,.131,.069-.021,.138-.044,.208-.068,.024,.255,.041,.505,.042,.723-.365,.429-1.203,.928-1.945,1.131-1.368,.433-1.852-.966-1.259-1.766Z" fill="#fff"></path>
                                    <path d="M16.342,16.611c.242-.267,1.915-.721,2.199-.864,.025-.071,.148-.321,.156-.373-.557,.05-2.089,.134-2.7,.103,.126-.108,.736-.422,1.182-.554,.042,.074,.073,.148,.079,.212,.032-.033,.056-.142,.048-.253,.293-.093,.443-.124,.508-.142,.041-.053,.114-.268,.125-.425-.359-.659-1.502-.446-.957,.322-.457,.192-1.222,.541-1.44,.856l-.035,.017c-.009,.017-.069,.266-.089,.343-.262-.782-.341-1.798-.795-2.093-.247,.506,.507,1.512,.517,2.056-.142,.33-1.991,1.757-2.309,.939,1.134-.431,2.304-1.185,1.336-2.289-.01-.041,.115,.017,.188,.02,.053-.113-.348-.347-.448-.46-.089-.016-.103,.303-.102,.38,.123,.179,.492,.887,.586,1.102-.139,.177-.837,.553-1.518,.863,.005-.176,.414-.656,.299-.786-.283,.515-.322-.323-.122-.485,.201-.642-.663,.951-.09,.897-.06,.114-.134,.253-.187,.419-.792,.369-2,.72-2.528,.893,.029-.094,.025-.174-.006-.15-.542,.637-.017-.81-.096-.67-.302,.23-.48,1.59,.087,.861,.44-.099,1.918-.203,2.471-.534,.084,1.499,2.627-.297,2.513-1.062,.064,.906,.55,1.539,1.847,1.609,.003-.103-.038-.425-.038-.425-.164-.023-.579-.086-.68-.326Zm-.913-.73c.257,.005,1.655-.032,1.921-.04-.491,.171-1.171,.271-1.14,.96-.403-.091-.624-.464-.781-.92Z" fill="#fff"></path>
                                    <path d="M12.822,13.817c.459-.246,.482-1.398,.854-1.685-.765,1.473,1.05,2.445,1.404,.667,.322,1.701,2.18,.64,1.302-.691-.241-.549,.228,.023,.066-.334-.251-.316-.358-.681-.477-.079,.16,.291,.317,1.085,.451,1.42-1.359,.72-.927-1.166-1.428-1.825-.024,.057-.13,.41-.13,.41,.838,1.883-1.884,2.344-.998,.137-.447-.722-.639,1.657-1.145,1.614-.411,0-.413-.913-.358-1.107-.292,.019-.146,1.653,.458,1.473Z" fill="#fff"></path>
                                    <path d="M23.777,14.233c.057,.949,.148,1.852,.117,2.524,.349-.356,.155-1.494,.145-2.223,.438,.519,.919,1.113,1.024,1.678,.013,.036,.069-.11,.06-.338,.048-.4-.665-1.312-1.115-1.788,.058-.461-.361-1.665-.114-1.934,.161,.186,.185,.105,.072-.126-.194-.304-.337-1.009-.476-.298,.17,.367,.134,1.245,.25,2.057-.385-.43-.627-.687-.828-.906,.011-.189-.181-.792,.017-.716,.161,.185,.185,.105,.072-.127-.205-.324-.348-1.024-.491-.286,.133,.193,.073,.417,.129,.814-.3-.442-.684-.627-.168-.578-.212-.149-1.029-.919-.813-.171,.305,.143,.63,.818,1.022,1.192,.063,.847,.258,2.221,.288,3.015-.809,.711-.96,.011-1.425-.246,.002-.225-.005-.444-.005-.573,.11-.505-.579-3.324-.041-2.908-.042-.23-.467-1.414-.568-.555,.225,.773,.255,2.393,.371,3.462,.011,.101,.024,.291,.035,.497-.002,0-.003-.001-.004-.002-.664,.19-.965,2.265-1.701,1.066,1.334-1.002,.41-3.321,.327-4.613,.008-.082,.139,.112,.207,.126,.049-.187-.281-.67-.399-.912-.476,.972,.751,3.11,.284,4.421,.061-.629-.685-1.392-1.221-1.883,.048-.267-.519-2.128-.024-1.609,.045-.023-.005-.16-.067-.282-.198-.331-.312-.975-.476-.273,.137,.173,.197,1.62,.287,1.904-.317-.37-1.855-1.462-1.123-1.362-.006-.02-.038-.068-.119-.117-.276-.09-.873-.788-.694-.054,.038,.003,.106,.049,.155,.107,.379,.518,1.263,1.37,1.843,1.886,.221,2.776,.599,3.546,.278,.267,.461,.469,.995,.976,1.103,1.565-.097,.201-.238,.38-.445,.525-.058-.379,.005-.686-.05-.715-.115,.07-.081,.556-.059,.79-1.629,.876-1.893,1.088,.063,.311,.679,1.706,1.129-.408,1.804-.783,.018,.016,.033,.025,.051,.04,.007,.215,.008,.399-.001,.459,.09-.001,.139-.14,.165-.33,1.967,1.537,1.697-1.371,1.455-2.888,.33,.384,.542,.608,.806,.888Z" fill="#fff"></path>
                                    <path d="M22.159,20.66h0s-1.5,0-1.5,0c.115-.083,.176-.205,.159-.327-.01-.077-.087-.135-.181-.143h-.047c-.114,.011-.196,.093-.184,.183l.005,.035,.006,.053c.006,.067,0,.134-.019,.199H9.313c.165,.24,.465,.386,.789,.386l10.116-.006c-.116,.083-.176,.205-.16,.328,.012,.09,.114,.154,.227,.143,.114-.011,.196-.093,.184-.183l-.005-.035-.006-.053c-.006-.067,0-.134,.019-.2h1.248s.035,.058,.035,.058c.031,.053,.071,.1,.117,.142l.064,.053h0c.126,.088,.287,.14,.456,.14,.16,0,.289-.111,.289-.248v-.072c0-.25-.237-.453-.529-.453Z" fill="#fff"></path>
                                </svg>
                            }
                        </a>
                    </li>

                    <li class="dropdown pc-h-item">
                        <a class="pc-head-link head-link-secondary dropdown-toggle arrow-none me-0 position-relative"
                           data-bs-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                            <i class="ti ti-bell"></i>
                            <span id="notification-badge-outer"
                                  class="badge bg-danger position-absolute top-0 start-100 translate-middle rounded-circle @(unreadCount > 0 ? "" : "d-none")"
                                  style="font-size: 10px; padding: 3px 6px; border: 2px solid #fff;">
                                @unreadCount
                            </span>
                        </a>

                        <div class="dropdown-menu dropdown-menu-end pc-h-dropdown p-0" style="width: 300px; border-radius: 12px; overflow: hidden; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                            <div class="p-3 text-white" style="background-color: #0053B3;">
                                <div class="d-flex align-items-center justify-content-between">
                                    <h6 class="m-0 text-white">@(isArabic ? "التنبيهات" : "Notifications")</h6>
                                    <span id="notification-badge" class="badge bg-white text-primary" style="color: #0053B3 !important;">
                                        @unreadCount.ToString("00")
                                    </span>
                                </div>
                            </div>

                            <div id="notification-list" style="max-height: 250px; overflow-y: auto; background: #fff;">
                                @if (unreadCount == 0)
                                {
                                    <div id="no-notifications-msg" class="p-4 text-center">
                                        <i class="ti ti-mail-opened d-block mb-2 text-muted" style="font-size: 24px;"></i>
                                        <p class="text-muted small mb-0">@(isArabic ? "لا توجد رسائل جديدة" : "No new messages")</p>
                                    </div>
                                }
                            </div>

                            <div class="p-2 bg-light border-top">
                                <a href="/Admin/ContactUs" class="btn btn-sm w-100 text-white" style="background-color: #0053B3; transition: 0.3s; border-radius: 8px;">
                                    @(isArabic ? "عرض كل الرسائل" : "View All Messages")
                                </a>
                            </div>
                        </div>
                    </li>

                    <li class="dropdown pc-h-item header-user-profile">
                        <a class="pc-head-link head-link-primary dropdown-toggle arrow-none me-0" data-bs-toggle="dropdown" href="#" role="button">
                            <img src="@(!string.IsNullOrEmpty(userImage) ? Url.Content("~/images/users/" + userImage) : $"https://ui-avatars.com/api/?name={displayName}&background=fffaf5&color=fd7e14&size=128")"
                                 alt="user-image"
                                 class="user-avtar"
                                 style="width: 40px; height: 40px; object-fit: cover; border-radius: 50%;" />
                            <span><i class="ti ti-settings"></i></span>
                        </a>
                        <div class="dropdown-menu dropdown-user-profile dropdown-menu-end pc-h-dropdown">
                            <div class="dropdown-header">
                                <h4>
                                    @(isArabic ? "مرحباً،" : "Hello,")
                                    <span class="small text-muted">@displayName</span>
                                </h4>
                                <p class="text-muted">@(isArabic ? "لوحة تحكم المشرف" : "Admin Dashboard")</p>

                                <div class="profile-notification-scroll position-relative" style="max-height: calc(100vh - 280px)">

                                    <a asp-area="Identity" asp-controller="MyProfile" asp-action="MyProfile" class="dropdown-item">


                                        <i class="ti ti-settings"></i>
                                        <span>@(isArabic ? "إعدادات الحساب" : "Account Settings")</span>
                                    </a>
                                    <a asp-action="Logout" asp-controller="Account" asp-area="Identity" class="dropdown-item">
                                        <i class="ti ti-logout"></i>
                                        <span>@(isArabic ? "تسجيل الخروج" : "Logout")</span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <div class="pc-container">
        <div class="pc-content">
            @RenderBody()
        </div>
    </div>

    <footer class="pc-footer">
        <div class="footer-wrapper container-fluid">
            <div class="row">
                <div class="col-sm-6 my-1">
                    <p class="m-0">
                        @(isArabic ? "تم التطوير بكل حب بواسطة" : "Berry ♥ crafted by Team")
                        <a href="#" target="_blank">CodedThemes</a>
                    </p>
                </div>
                <div class="col-sm-6 ms-auto my-1">
                    <ul class="list-inline footer-link mb-0 justify-content-sm-end d-flex">
                        <li class="list-inline-item"><a href="/">@(isArabic ? "الرئيسية" : "Home")</a></li>
                        <li class="list-inline-item"><a href="#">@(isArabic ? "التعليمات" : "Documentation")</a></li>
                        <li class="list-inline-item"><a href="#">@(isArabic ? "الدعم" : "Support")</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>

    <script src="~/assets/js/plugins/popper.min.js"></script>
    <script src="~/assets/js/plugins/simplebar.min.js"></script>
    <script src="~/assets/js/plugins/bootstrap.min.js"></script>
    <script src="~/assets/js/script.js"></script>
    <script src="~/assets/js/theme.js"></script>
    <script src="~/assets/js/plugins/feather.min.js"></script>
    <script src="~/assets/js/plugins/apexcharts.min.js"></script>
    <script src="/lib/jquery/dist/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.0/signalr.min.js"></script>

    <script>
        layout_change('light');
        font_change('Roboto');
        change_box_container('false');
        layout_caption_change('true');
        layout_rtl_change('false');
        preset_change('preset-1');
    </script>

    <script>
        $(document).ready(function () {
            var successMessage = '@TempData["Success"]';
            var errorMessage = '@TempData["Error"]';


            function showToast(message, icon) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 4000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    },

                    showClass: {
                        popup: 'animate__animated animate__shakeX'
                    },
                    hideClass: {
                        popup: 'animate__animated animate__fadeOutRight'
                    }
                });

                Toast.fire({
                    icon: icon,
                    title: message
                });
            }

            if (successMessage && successMessage !== '') {
                showToast(successMessage, 'success');
            }

            if (errorMessage && errorMessage !== '') {
                showToast(errorMessage, 'error');
            }
        });
    </script>


    <script>
        var connection = new signalR.HubConnectionBuilder()
            .withUrl("/realTimeHub")
            .build();

               connection.on("ReceiveMessage", function (title, message) {
            // 1. تحديث العدادات (خارجي وداخلي)
            var badgeOuter = document.getElementById("notification-badge-outer");
            var badgeInner = document.getElementById("notification-badge");

            var currentCount = parseInt(badgeOuter.innerText) || 0;
            var newCount = currentCount + 1;

            if (badgeOuter) {
                badgeOuter.innerText = newCount;
                badgeOuter.classList.remove("d-none");
            }
            if (badgeInner) {
                badgeInner.innerText = newCount < 10 ? "0" + newCount : newCount;
            }

            // 2. إخفاء رسالة "لا يوجد إشعارات" إذا كانت موجودة
            var noMsg = document.getElementById("no-notifications-msg");
            if (noMsg) noMsg.style.display = 'none';

            // 3. إضافة الإشعار الجديد بتنسيق متوافق مع الألوان (استخدام اللون الأصفر من Palette)
            var list = document.getElementById("notification-list");
            var item = `
                <a href="/Admin/ContactUs" class="dropdown-item py-3 border-bottom animate__animated animate__fadeInDown" style="background: #f8f9fa;">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <div class="avtar avtar-s bg-light-warning">
                                <i class="ti ti-mail text-warning" style="color: #FCC247 !important;"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-0 fw-bold" style="font-size: 13px;">${title}</h6>
                            <small class="text-muted">@(isArabic ? "رسالة جديدة الآن" : "New message just now")</small>
                        </div>
                    </div>
                </a>`;

            list.insertAdjacentHTML('afterbegin', item);

            // 4. تشغيل الصوت
            try {
                var audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3');
                audio.play();
            } catch (e) { console.log("Audio play blocked"); }

            // 5. الـ Toast
            showToast(title, 'info');
        });

        connection.start().catch(err => console.error(err.toString()));
    </script>


    @await RenderSectionAsync("Scripts", required: false)

    <script>
        $(document).ready(function () {
            var successMessage = '@TempData["Success"]';
            var errorMessage = '@TempData["Error"]';


            function showToast(message, icon) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 4000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    },

                    showClass: {
                        popup: 'animate__animated animate__shakeX'
                    },
                    hideClass: {
                        popup: 'animate__animated animate__fadeOutRight'
                    }
                });

                Toast.fire({
                    icon: icon,
                    title: message
                });
            }

            if (successMessage && successMessage !== '') {
                showToast(successMessage, 'success');
            }

            if (errorMessage && errorMessage !== '') {
                showToast(errorMessage, 'error');
            }
        });
    </script>

</body>
</html>